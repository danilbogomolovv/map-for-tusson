{% extends "base.html" %}

{% block nav %}
    <a class="btn btn-outline-danger" href="/" role="button">Назад</a>
{% endblock nav %}

{% block content %}
    <div class="terminals_for_repair" id="terminals_for_repair" style="display: block; background: #212529; color: #9e9e9e; height: 95%; overflow: auto; width: 16%;">
        <ul>
            <div class="d-grid gap-2">
                <button  class="btn btn-outline-success btn-sm active" type="button" onclick="ShowFormCloseTids()">Фильтр</button>
                <button class="btn btn-outline-success btn-sm active" type="button" onclick="ShowTidsCloseForm()">Тиды</button>

                <div class="repair_form" id="repair_form" style="display: none">
                        <form method=POST action="" class="form-container" style=" align-items: center">
                            {% csrf_token %}
                            <table>
                                <div class="ui-widget">
                                    <table>
                                        {% for field in repair_form %}
                                          <tr>
                                              <td>{{field.label}}</td>
                                              <td>{{field}}</td>
                                              <td><button class="btn btn-outline-danger btn-sm" onclick="ClearFormField('{{field.id_for_label}}')">-</button></td>
                                          </tr> 
                                        {% endfor %}
                                       
                                    </table>
                                </div>
                            </table>
                                <button type="submit" class="btn btn-outline-success" id="repair_form_make_button" style="display: none">Применить</button>
                                <button class="btn btn-outline-danger" onclick="clearfilters()" id="repair_form_clear_button" style="display: none">Сбросить</button>
                        </form>
                </div>

                <div class="repair_tids" id="repair_tids" style="display: none">
                    {% for j in terminals_for_repair %}
                        {% for i in j.terminals.all %}
                        <li>
                            {% if i.ddatap < now_date %}
                            <button type="button" class="btn btn-secondary btn-sm" onclick="ShowTerminalForRepairInfo('{{i.lat}}','{{i.lng}}', '{{i.ddatap}}','{{i.cmemo}}','{{i.cparta}}', '{{i.cadres}}')">TID : {{i.ctid}}</button><span style="color: red">(ПРОСРОЧЕНО!)</span> 
                            {% else %}
                            <button type="button" class="btn btn-secondary btn-sm" onclick="ShowTerminalForRepairInfo('{{i.lat}}','{{i.lng}}', '{{i.ddatap}}','{{i.cmemo}}','{{i.cparta}}', '{{i.cadres}}')">TID : {{i.ctid}}</button>
                            {% endif %}
                        </li>
                        {% endfor %}
                    {% endfor %}
                </div>
             </div>
        </ul>
    </div>

    <div class="terminals_for_repair_info" id="terminals_for_repair_info" style="display: none; background: #212529; color: #9e9e9e; height: 95%; overflow: auto; width: 23%;">
         

         <button class="btn btn-outline-danger" onclick="ClearRepairInfo()">Сбросить</button>   
    </div>
{% endblock content %}


        {% block available %}

        try {
        var availableparts = '{{ availablecparta|safe }}'.replace('[','').replace(']','').replace('"','')
        availableparts = availableparts.split('", "')
        } catch {
            console.log('error availableparts')
        }
    
        try {
        var availablezones = '{{ availablezona_name|safe }}'.replace('[','').replace(']','').replace('"','')
        availablezones = availablezones.split('", "')
        } catch {
            console.log('error availablezones')
        }
        
        try {
        var availablenames = '{{ availablecname|safe }}'.replace('[','').replace(']','').replace('"','')
        availablenames = availablenames.split('", "')
        } catch {
            console.log('error availablenames')
        }

        try {
        var availableinrs = '{{ availableinr|safe }}'.replace('[','').replace(']','').replace('"','')
        availableinrs = availableinrs.split('", "')
        } catch {
            console.log('error availableinrs')
        }

        try {
        var availablegorod = '{{ availablecgorod|safe }}'.replace('[','').replace(']','').replace('"','')
        availablegorod = availablegorod.split('", "')
        } catch {
            console.log('error availablegorod')
        }

        try {
        var availablectids = '{{ availablectid|safe }}'.replace('[','').replace(']','').replace('"','')
        availablectids = availablectids.split('", "')
        } catch {
            console.log('error availablectids')
        }

        try {
        var availabletypes = '{{ availablectype|safe }}'.replace('[','').replace(']','').replace('"','')
        availabletypes = availabletypes.split('", "')
        } catch {
            console.log('error availabletypes')
        }

        try {
        var availablebanks = '{{ availablecbank|safe }}'.replace('[','').replace(']','').replace('"','')
        availablebanks = availablebanks.split('", "')
        } catch {
            console.log('error availablebanks')
        }

        try {
        var availablecunns = '{{ availablecunn|safe }}'.replace('[','').replace(']','').replace('"','')
        availablecunns = availablecunns.split('", "')
        } catch {
            console.log('error availableparts')
        }

        try {
        var availablecvsobas = '{{ availablecvsoba|safe }}'.replace('[','').replace(']','').replace('"','')
        availablecvsobas = availablecvsobas.split('", "')
        } catch {
            console.log('error availablecvsobas')
        }

        try {
        var availablecpodr = '{{ availablecpodr|safe }}'.replace('[','').replace(']','').replace('"','')
        availablecpodr = availablecpodr.split('", "')
        } catch {
            console.log('error availableparts')
        }

        try {
        var availableadres = '{{ availablecadres|safe }}'.replace('[','').replace(']','').replace('"','')
        availableadres = availableadres.split('", "')
        } catch {
            console.log('error availableadres')
        }

        {% endblock available %}