<!DOCTYPE html>
<html>
    <head>
        <title>Tusson</title>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
        <script src="https://unpkg.com/@google/markerclustererplus@4.0.1/dist/markerclustererplus.min.js"></script>
        </head>

    <body>
    <div id="map"></div>

    <script type="text/javascript">
        let map;
        var markers = [];
        function initMap() {
            map = new google.maps.Map(document.getElementById("map"), {
            center: { lat: 53.904789501846196, lng: 27.553534868069242 },
            zoom: 6,
        });

            {% for i in terminals %}

            {% if i.lat != 'exist' and i.lng != 'exist' %}
            var infoWindow = new google.maps.InfoWindow();
                var marker = new google.maps.Marker({
                    map : map,
                    position : {lat: parseFloat('{{ i.lat }}'), lng: parseFloat('{{ i.lng }}')},
                    title : '{{ i.ctid }}'
                });
            var ctid = "{{ i.ctid }}";
            var cadres = "{{ i.cadres }}";
            var cname = "{{ i.cname }}"
                markers.push(marker);
              (function (marker, ctid, cadres, cname) {
                        google.maps.event.addListener(marker, "click", function (e) {
                            //Wrap the content inside an HTML DIV in order to set height and width of InfoWindow.
                            infoWindow.setContent("<div style = 'width:200px;min-height:40px'>" + '<p>' +  cadres + '</p>' + 
                                                    '<p>' + ctid + '</p>' + '<p>' + cname + '</p>' + "</div>");
                            infoWindow.open(map, marker);
                        });
                    })(marker, ctid, cadres, cname);
                
                //marker.addListener("click"
                //    , () => {
                  
                 //   alert("{{ i.cadres }}")
              
                //  });
            {% endif %}

            {% endfor %}

            new MarkerClusterer(map, markers, {
                imagePath:
                  "https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",
              });
        }

        function toggleBounce(cname) {
            console.log(cname)
      }
    </script>

    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC_CpD9oSCYYDu92Jq8EiIGklCgyelDbiw&callback=initMap&libraries=&v=weekly"
        async
    ></script>

    </body>
</html>

<style type="text/css">
    #map {
    height: 100%;
    }

    html,
    body {
    height: 100%;
    margin: 0;
    padding: 0;
    }
</style>